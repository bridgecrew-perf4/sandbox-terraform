// Generated by Selenium IDE
// New Relic Synthetics Formatter for Selenium IDE
// Feel free to explore, or check out the full documentation
// https://docs.newrelic.com/docs/synthetics/new-relic-synthetics/scripting-monitors/writing-scripted-browsers
// for details


  const assert = require("assert");
  const urlRequest = require("urllib").request;
  // Theshold for duration of entire script - fails test if script lasts longer than X (in ms)
  // Script-wide timeout for all wait and waitAndFind functions (in ms)
  var DefaultTimeout = 30000;
  // Change to any User Agent you want to use.
  // Leave as "default" or empty to use the Synthetics default.
  var UserAgent = "default";
  const By = $driver.By;
  const browser = $browser.manage();
  var vars = new Map();
  const logger = function({timeout:e=18e4,stepLogging:t=!1,insightsKey:n=""}){const r=Date.now();var s=0,o="",i=0,a=0;function l({step:e=0,msg:t="",duration:r=0,eventType:s="SyntheticsCustom",custom:o={}}){if(void 0===n||""==n)return;var i={method:"POST",headers:{"X-Insert-Key":n,"Content-Type":"application/json"},data:{eventType:s,step:e,message:t,duration:r,JOB_ID:$env.JOB_ID,MONITOR_ID:$env.MONITOR_ID,ACCOUNT_ID:$env.ACCOUNT_ID,LOCATION:$env.LOCATION,PROXY_HOST:$env.PROXY_HOST,PROXY_PORT:$env.PROXY_PORT},dataType:"text"};const a=`https://insights-collector.newrelic.com/v1/accounts/${$env.ACCOUNT_ID}/events`;i.data=Object.assign({},i.data,o),urlRequest(a,i)}function c(e,t,n=""){e>a&&0!=a&&_({testCase:n});let i=`Step ${e}: ${t} STARTED at ${s=Date.now()-r}ms. testCase=${n}`;console.log(i),o=t,a=e}function _({testCase:i=""}){var c=Date.now()-r,_=c-s;if(console.log(`Step ${a}: ${o} FINISHED. It took ${_}ms to complete. testCase=${i}`),t&&n.length>0?l({step:a,msg:o,duration:_,custom:{testCase:i}}):t&&$util.insights.set(`Step ${a}: ${o}`,_),e>0&&c>e)throw new Error("Script timed out. "+c+"ms is longer than script timeout threshold of "+e+"ms.")}return{logStep:function(e){c(i++,e)},log:c,getStep:function(){return i},end:_,endTestCase:function(e=""){var i=Date.now()-r-s;console.log(`Step ${a}: ${o} FINISHED. It took ${i}ms to complete.`),t&&n.length>0?l({step:a,msg:o,duration:i,custom:{testCase:e}}):t&&$util.insights.set(`Step ${a}: ${o}`,i),$util.insights.set("testCase",e),$util.insights.set("testCaseStatus","Pass"),t&&n.length>0&&l({eventType:"SyntheticsTests",custom:{testCase:e,testCaseStatus:"Pass"}})},error:function(e,r=""){console.log(`Error in Step ${a}: ${o}`),$util.insights.set("errorStep",""+a),$util.insights.set("errorMsg",e.message),$util.insights.set("errorLineNumber",e.lineNumber),$util.insights.set("testCase",r),$util.insights.set("testCaseStatus","fail"),t&&n.length>0&&l({eventType:"SyntheticsTests",custom:{testCase:r,testCaseStatus:"Fail"}})},postInsights:l}}({})
  $browser.getCapabilities().then(function () { })
  // Test Case: Generic Search  
  .then(function (){
  	return Promise.resolve(true)
  
    // Test name: Generic Search
    // Step # | name | target | value | comment
    // 1 | open | /cre/commercial-real-estate-listings-portfolio |  | 
    .then( function(){return logger.log(1,"Open URL https://riocan.propertycapsule.com/cre/commercial-real-estate-listings-portfolio","Generic Search"),$browser.get("https://riocan.propertycapsule.com/cre/commercial-real-estate-listings-portfolio").then(e=>e)})
    // 2 | setWindowSize | 1860x1053 |  | 
    .then( function(){return logger.log(2,"Set Window Size Width=1860 Height=1053","Generic Search"),$browser.manage().window().setSize(1860,1053).then(e=>e)})
    // 3 | select | id=city | label=Brampton, ON | 
    .then( function(){return logger.log(3,"Select By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then((function(e){return e.click(),logger.log(4,"Select By.xpath(\"//option[. = \'Brampton, ON\']\")","Generic Search"),$browser.waitForAndFindElement(By.xpath("//option[. = 'Brampton, ON']"),DefaultTimeout).then((function(e){return e.click(),Promise.resolve(!0)}))}))})
    // 4 | mouseDownAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(5,"Mouse Down","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseDown(e).perform()))})
    // 5 | mouseMoveAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(6,"Mouse move","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e).perform()))})
    // 6 | mouseUpAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(7,"Mouse up By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e,0,0).perform()))})
    // 7 | click | id=city |  | 
    .then( function(){return logger.log(8,"Click By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
    // 8 | click | id=property-search-submit |  | 
    .then( function(){return logger.log(9,"Click By.id(\"property-search-submit\")","Generic Search"),$browser.waitForAndFindElement(By.id("property-search-submit"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
    // 9 | select | id=city | label=Show All | 
    .then( function(){return logger.log(10,"Select By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then((function(e){return e.click(),logger.log(11,"Select By.xpath(\"//option[. = \'Show All\']\")","Generic Search"),$browser.waitForAndFindElement(By.xpath("//option[. = 'Show All']"),DefaultTimeout).then((function(e){return e.click(),Promise.resolve(!0)}))}))})
    // 10 | mouseDownAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(12,"Mouse Down","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseDown(e).perform()))})
    // 11 | mouseMoveAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(13,"Mouse move","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e).perform()))})
    // 12 | mouseUpAt | id=city | -354.703125,-338 | 
    .then( function(){return logger.log(14,"Mouse up By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e,0,0).perform()))})
    // 13 | click | id=city |  | 
    .then( function(){return logger.log(15,"Click By.id(\"city\")","Generic Search"),$browser.waitForAndFindElement(By.id("city"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
    // 14 | select | id=agent | label=Chris Conrod | 
    .then( function(){return logger.log(16,"Select By.id(\"agent\")","Generic Search"),$browser.waitForAndFindElement(By.id("agent"),DefaultTimeout).then((function(e){return e.click(),logger.log(17,"Select By.xpath(\"//option[. = \'Chris Conrod\']\")","Generic Search"),$browser.waitForAndFindElement(By.xpath("//option[. = 'Chris Conrod']"),DefaultTimeout).then((function(e){return e.click(),Promise.resolve(!0)}))}))})
    // 15 | mouseDownAt | id=agent | -1053.09375,-338 | 
    .then( function(){return logger.log(18,"Mouse Down","Generic Search"),$browser.waitForAndFindElement(By.id("agent"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseDown(e).perform()))})
    // 16 | mouseMoveAt | id=agent | -1053.09375,-338 | 
    .then( function(){return logger.log(19,"Mouse move","Generic Search"),$browser.waitForAndFindElement(By.id("agent"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e).perform()))})
    // 17 | mouseUpAt | id=agent | -1053.09375,-338 | 
    .then( function(){return logger.log(20,"Mouse up By.id(\"agent\")","Generic Search"),$browser.waitForAndFindElement(By.id("agent"),DefaultTimeout).then(e=>Promise.resolve($browser.actions().mouseMove(e,0,0).perform()))})
    // 18 | click | id=agent |  | 
    .then( function(){return logger.log(21,"Click By.id(\"agent\")","Generic Search"),$browser.waitForAndFindElement(By.id("agent"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
    // 19 | click | id=property-search-submit |  | 
    .then( function(){return logger.log(22,"Click By.id(\"property-search-submit\")","Generic Search"),$browser.waitForAndFindElement(By.id("property-search-submit"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
    // 20 | click | css=.full-portfolio |  | 
    .then( function(){return logger.log(23,"Click By.css(\".full-portfolio\")","Generic Search"),$browser.waitForAndFindElement(By.css(".full-portfolio"),DefaultTimeout).then(e=>(e.click(),Promise.resolve(!0)))})
  	.then(function() {
  		logger.endTestCase("Generic Search");
  	}, function(err) {
  		logger.error (err, "Generic Search");
  		throw(err);
  	});
  
  })
  
